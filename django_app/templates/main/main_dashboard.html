{% extends "base.html" %}
{% load static sass_tags humanize %}

{% block title %}MedAI Research - 메인{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% sass_src 'css/main-dashboard.scss' %}">
{% endblock %}

{% block content %}
    <div
      class="main-page"
      data-dashboard
      data-user-name="{{ user_name }}"
      data-user-email="{{ user_email }}"
      data-chat-url="{{ chat_url }}"
      data-logout-url="{{ logout_url }}"
      data-show-logout="{{ show_logout|yesno:'true,false' }}"
    >
      <header class="main-header">
        <div class="container header-padding">
          <div class="flex-between">
            <div class="flex-gap-sm">
              <div class="badge-square brand-badge">
                <!-- <i class="fa-solid fa-robot brand-badge__icon"></i> -->
                <img src="/static/img/medai-logo.png" alt="MedAI 로고" class="brand-badge__image">
              </div>
              <div>
                <h1 class="brand-title">MedAI Research</h1>
                <p class="brand-subtitle">의료 연구 AI 어시스턴트</p>
              </div>
            </div>
            <div class="flex-gap-md">
              <div class="flex-gap-sm">
                <div class="badge-circle user-avatar">
                  <i class="fa-solid fa-user"></i>
                </div>
                <div class="text-right">
                  <div id="userName" class="user-name"></div>
                  <div id="userEmail" class="user-email"></div>
                </div>
              </div>
              {% if show_logout %}
              <button id="logoutBtn" class="icon-button" title="로그아웃">
                <i class="fa-solid fa-arrow-right-from-bracket logout-icon"></i>
              </button>
              {% endif %}
            </div>
          </div>
        </div>
      </header>

      <main class="container page-padding">
        <div class="section-hero">
          <h2 class="hero-title">의료 연구를 위한 AI 어시스턴트</h2>
          <p class="hero-description">
            최신 의학 논문 데이터베이스를 기반으로 신뢰할 수 있는 정보를 제공합니다.
            림프절 전이 예측, MMP/TIMP 발현, 임상시험 검색 등 전문적인 의학 질문에 대해
            검증된 참고문헌과 함께 답변을 받아보세요.
          </p>
          <button id="startChatBtn" class="btn btn-primary btn-large">
            AI 채팅 시작하기
            <i class="fa-solid fa-arrow-right text-white"></i>
          </button>
        </div>

        <div class="section-spacing">
          <h3 class="section-title">플랫폼 현황</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
              <div class="flex-gap-sm">
                <div class="stat-icon bg-soft-blue">
                  <i class="fa-solid fa-book-medical text-brand-blue-dark"></i>
                  </div>
                  <p class="stat-title">총 논문 수</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.total_papers|intcomma }}</p>
              </div>
            </div>

            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
                <div class="flex-gap-sm">
                  <div class="stat-icon bg-soft-green">
                    <i class="fa-solid fa-comments text-accent-green"></i>
                  </div>
                  <p class="stat-title">총 연구 질문 수</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.total_research_questions|default:0|intcomma }}</p>
              </div>
            </div>

            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
                <div class="flex-gap-sm">
                  <div class="stat-icon bg-soft-lime">
                    <i class="fa-solid fa-chart-line text-lime"></i>
                  </div>
                  <p class="stat-title">AI 답변 정확도</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.ai_answer_accuracy|default:0|floatformat:-2 }}%</p>
              </div>
            </div>

            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
                <div class="flex-gap-sm">
                  <div class="stat-icon bg-soft-amber">
                    <i class="fa-solid fa-magnifying-glass-chart text-amber"></i>
                  </div>
                  <p class="stat-title">RAG 검색 적합도</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.rag_matching_rate|default:0|floatformat:-2 }}</p>
              </div>
            </div>

            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
                <div class="flex-gap-sm">
                  <div class="stat-icon bg-soft-indigo">
                    <i class="fa-solid fa-building-columns text-indigo"></i>
                  </div>
                  <p class="stat-title">문헌 검색 활용도</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.internal_usage_rate|default:0|floatformat:-2 }}%</p>
              </div>
            </div>

            <div class="card stat-card stat-card--padded">
              <div class="stat-card-header">
                <div class="flex-gap-sm">
                  <div class="stat-icon bg-soft-pink">
                    <i class="fa-solid fa-earth-asia text-pink"></i>
                  </div>
                  <p class="stat-title">외부 지식 활용도</p>
                </div>
              </div>
              <div>
                <p class="stat-value">{{ dashboard_stats.external_usage_rate|default:0|floatformat:-2 }}%</p>
              </div>
            </div>
          </div>
        </div>

        <div class="section-spacing">
          <h3 class="section-title">주요 기능</h3>
          <div class="grid grid-cols-1 md:grid-cols-3">
            <div class="card card--padded">
              <div class="feature-header">
                <div class="feature-icon bg-soft-blue">
                  <i class="fa-solid fa-certificate text-brand-blue-dark"></i>
                </div>
                <h4 class="feature-title">국내 Big 5 병원 참여</h4>
              </div>
              <p class="feature-content">
                서울성모병원, 삼성서울병원, 서울대병원, 세브란스병원, 서울시 보라매병원이 구축에 참여했습니다.
              </p>
            </div>

            <div class="card card--padded">
              <div class="feature-header">
                <div class="feature-icon bg-soft-green">
                  <i class="fa-solid fa-book-open-reader text-accent-green"></i>
                </div>
                <h4 class="feature-title">필수의료 지식 개방</h4>
              </div>
              <p class="feature-content">
                임상 근거가 명확한 필수의료 지식 Q&amp;A 1.5만 쌍, 전문 의료 안내문, 동의서 등 고품질 의학 자료를 제공해 누구나 활용할 수 있습니다.
              </p>
            </div>

            <div class="card card--padded">
              <div class="feature-header">
                <div class="feature-icon bg-soft-violet">
                  <i class="fa-solid fa-bolt text-violet"></i>
                </div>
                <h4 class="feature-title">다양한 의료 데이터 출처</h4>
              </div>
              <p class="feature-content">
                학술 논문, 국제/국내 가이드라인, 의료 교과서, 동의서 등 타당성이 검증된 데이터를 통합했습니다.
              </p>
            </div>
          </div>
        </div>
      </main>
    </div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/main-dashboard.js' %}" defer></script>
{% endblock %}
